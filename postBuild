#!/bin/bash

echo "ðŸ”§ Setting up dashboard environment..."

# Enable Jupyter widgets
jupyter nbextension enable --py widgetsnbextension --sys-prefix

# Install JupyterLab extensions
jupyter labextension install @jupyter-widgets/jupyterlab-manager --no-build
jupyter labextension install jupyterlab-plotly --no-build
jupyter lab build --dev-build=False --minimize=False

# Enable Voila
jupyter serverextension enable voila --sys-prefix

# Create Voila configuration
mkdir -p ~/.jupyter
cat > ~/.jupyter/voila_config.py << 'EOF'
c = get_config()
c.Voila.template = 'material'
c.Voila.theme = 'light'
c.Voila.enable_nbextensions = True
c.VoilaConfiguration.file_whitelist = ['.*\\.(png|jpg|svg|css|js)$']
c.VoilaConfiguration.show_tracebacks = False
c.TagRemovePreprocessor.remove_cell_tags = {'remove_cell'}
c.TagRemovePreprocessor.remove_all_outputs_tags = {'remove_output'}
c.TagRemovePreprocessor.remove_input_tags = {'remove_input'}
EOF

# Create minimal CSS
mkdir -p assets
cat > assets/minimal.css << 'EOF'
:root {
    --color-primary: #2D3748;
    --color-secondary: #4A5568;
    --color-accent: #718096;
    --color-background: #F7FAFC;
    --color-surface: #FFFFFF;
    --color-text: #1A202C;
    --color-text-light: #718096;
    --color-border: #E2E8F0;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    background: var(--color-background);
}

.widget-dropdown select {
    border: 1px solid var(--color-border);
    border-radius: 6px;
    padding: 10px 12px;
    background: var(--color-surface);
    color: var(--color-text);
    font-family: inherit;
    font-size: 0.875rem;
}

.widget-dropdown select:focus {
    outline: none;
    border-color: var(--color-accent);
    box-shadow: 0 0 0 3px rgba(113,128,150,0.1);
}

.jp-Notebook { background: transparent; }
.jp-Cell { background: transparent; }
EOF

echo "âœ… Dashboard environment ready!"